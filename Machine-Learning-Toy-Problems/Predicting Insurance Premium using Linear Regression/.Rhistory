setwd("~/Code/Data Science Projects/Machine-Learning-with-R---Brett-Lantz/Predicting Insurance Premium using Linear Regression")
# Insurance - Predicting Medical Expenses
setwd(paste0("~/Code/Data Science Projects/Machine-Learning-with-R---Brett-Lantz
/Predicting Insurance Premium using Linear Regression"))
# reading, exploring and preparing data
insurance <- read.csv('insurance.csv', stringsAsFactors = T)
str(insurance)
# checking for normal distribution
# although linear regression does not strictly require a normally distributed
# dependent variable, the model often fits better when this is true.
summary(insurance$charges)
# Because the mean value is greater than the median, this implies that the
# distribution of insurance expenses is right-skewed.
hist(insurance$charges)
table(insurance$region)
# Exploring relationships among features
cor(insurance[c('age', 'bmi', 'children', 'charges')])
# Insurance - Predicting Medical Expenses
setwd(paste0("~/Code/Data Science Projects/",
"Machine-Learning-with-R---Brett-Lantz",
"/Predicting Insurance Premium using Linear Regression"))
# reading, exploring and preparing data
insurance <- read.csv('insurance.csv', stringsAsFactors = T)
str(insurance)
# checking for normal distribution
# although linear regression does not strictly require a normally distributed
# dependent variable, the model often fits better when this is true.
summary(insurance$charges)
# Because the mean value is greater than the median, this implies that the
# distribution of insurance expenses is right-skewed.
hist(insurance$charges)
table(insurance$region)
# Exploring relationships among features
cor(insurance[c('age', 'bmi', 'children', 'charges')])
# Predicting Insurance Premium
setwd(paste0("~/Code/Data Science Projects/",
"Machine-Learning-with-R---Brett-Lantz",
"/Predicting Insurance Premium using Linear Regression"))
# reading, exploring and preparing data
insurance <- read.csv('insurance.csv', stringsAsFactors = T)
str(insurance)
# checking for normal distribution
# although linear regression does not strictly require a normally distributed
# dependent variable, the model often fits better when this is true.
summary(insurance$charges)
# Because the mean value is greater than the median, this implies that the
# distribution of insurance expenses is right-skewed.
hist(insurance$charges)
table(insurance$region)
# Exploring relationships among features
cor(insurance[c('age', 'bmi', 'children', 'charges')])
#
pairs(insurance[c('age', 'bmi', 'children', 'charges')])
install.packages('psych')
library(psych)
pairs.panels(insurance[c('age', 'bmi', 'children', 'charges')])
View(insurance)
insurance.model <- lm(formula = charges ~ ., data = insurance)
insurance.model
summary(insurance.model)
insurance$age2 <- insurance$age ^ 2
insurance$bmi30 <- ifelse(insurance$bmi >= 30, 1, 0)
insurance.model2 <- lm(formula = charges ~ age + age2 + sex + children
+ region + bmi30 * smoker)
insurance.model2 <- lm(formula = charges ~ age + age2 + sex + children
+ region + bmi30 * smoker, data = insurance)
summary(insurance.model2)
